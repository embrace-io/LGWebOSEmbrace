'use strict';

var index = require('./constants/index.cjs');
var generateUUID = require('../utils/generateUUID.cjs');

const getAppInstanceId = (pageSessionStorage, diag)=>{
    let id = null;
    try {
        id = pageSessionStorage.getItem(index.EMBRACE_APP_INSTANCE_ID_STORAGE_KEY);
    } catch (e) {
        diag.warn('Failed to retrieve app instance ID from session storage', e);
    }
    if (!id) {
        diag.debug('No existing app instance ID found in session storage, creating a new one');
        id = generateUUID.generateUUID();
        try {
            pageSessionStorage.setItem(index.EMBRACE_APP_INSTANCE_ID_STORAGE_KEY, id);
        } catch (e) {
            diag.warn('Failed to persist app instance ID to session storage', e);
        }
    }
    return id;
};

exports.getAppInstanceId = getAppInstanceId;
//# sourceMappingURL=appInstanceId.cjs.map
