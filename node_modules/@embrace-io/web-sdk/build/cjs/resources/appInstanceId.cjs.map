{"version":3,"file":"appInstanceId.cjs","sources":["../../../src/resources/appInstanceId.ts"],"sourcesContent":["import { EMBRACE_APP_INSTANCE_ID_STORAGE_KEY } from './constants/index.js';\nimport { generateUUID } from '../utils/index.js';\nimport type { DiagLogger } from '@opentelemetry/api';\n\nexport const getAppInstanceId = (\n  pageSessionStorage: Storage,\n  diag: DiagLogger\n): string => {\n  let id = null;\n  try {\n    id = pageSessionStorage.getItem(EMBRACE_APP_INSTANCE_ID_STORAGE_KEY);\n  } catch (e) {\n    diag.warn('Failed to retrieve app instance ID from session storage', e);\n  }\n\n  if (!id) {\n    diag.debug(\n      'No existing app instance ID found in session storage, creating a new one'\n    );\n    id = generateUUID();\n    try {\n      pageSessionStorage.setItem(EMBRACE_APP_INSTANCE_ID_STORAGE_KEY, id);\n    } catch (e) {\n      diag.warn('Failed to persist app instance ID to session storage', e);\n    }\n  }\n\n  return id;\n};\n"],"names":["getAppInstanceId","pageSessionStorage","diag","id","getItem","EMBRACE_APP_INSTANCE_ID_STORAGE_KEY","e","warn","debug","generateUUID","setItem"],"mappings":";;;;;AAIO,MAAMA,gBAAAA,GAAmB,CAC9BC,kBAAAA,EACAC,IAAAA,GAAAA;AAEA,IAAA,IAAIC,EAAAA,GAAK,IAAA;IACT,IAAI;QACFA,EAAAA,GAAKF,kBAAAA,CAAmBG,OAAO,CAACC,yCAAAA,CAAAA;AAClC,IAAA,CAAA,CAAE,OAAOC,CAAAA,EAAG;QACVJ,IAAAA,CAAKK,IAAI,CAAC,yDAAA,EAA2DD,CAAAA,CAAAA;AACvE,IAAA;AAEA,IAAA,IAAI,CAACH,EAAAA,EAAI;AACPD,QAAAA,IAAAA,CAAKM,KAAK,CACR,0EAAA,CAAA;QAEFL,EAAAA,GAAKM,yBAAAA,EAAAA;QACL,IAAI;YACFR,kBAAAA,CAAmBS,OAAO,CAACL,yCAAAA,EAAqCF,EAAAA,CAAAA;AAClE,QAAA,CAAA,CAAE,OAAOG,CAAAA,EAAG;YACVJ,IAAAA,CAAKK,IAAI,CAAC,sDAAA,EAAwDD,CAAAA,CAAAA;AACpE,QAAA;AACF,IAAA;IAEA,OAAOH,EAAAA;AACT;;;;"}