{"version":3,"file":"nsfConfigValidation.cjs","sources":["../../../src/utils/nsfConfigValidation.ts"],"sourcesContent":["import type { SDKFeaturesManager } from '../managers/index.js';\nimport type { SDKInitConfig } from '../sdk/index.js';\nimport type { DiagLogger } from '@opentelemetry/api';\n\ntype ValidateConfigArgs = {\n  featureManager: SDKFeaturesManager;\n  diag: DiagLogger;\n} & Pick<\n  SDKInitConfig,\n  'propagator' | 'registerGlobally' | 'defaultInstrumentationConfig'\n>;\n\nexport const nsfConfigValidation = ({\n  diag,\n  featureManager,\n  registerGlobally,\n  propagator,\n  defaultInstrumentationConfig,\n}: ValidateConfigArgs) => {\n  if (!featureManager.isNetworkSpanForwardingEnabled()) {\n    return false;\n  }\n\n  const warnings = [];\n\n  if (!registerGlobally) {\n    warnings.push(\n      'Network span forwarding cannot be used when `registerGlobally` is set to false. Turning off network span forwarding.'\n    );\n  }\n\n  if (propagator) {\n    warnings.push(\n      'Network span forwarding cannot be used alongside a custom `propagator`. Turning off network span forwarding.'\n    );\n  }\n\n  if (\n    defaultInstrumentationConfig?.omit?.has(\n      '@opentelemetry/instrumentation-xml-http-request'\n    ) &&\n    defaultInstrumentationConfig.omit.has(\n      '@opentelemetry/instrumentation-fetch'\n    )\n  ) {\n    warnings.push(\n      \"Network span forwarding cannot be used when both '@opentelemetry/instrumentation-xml-http-request' and \" +\n        \"'@opentelemetry/instrumentation-fetch' are omitted. Turning off network span forwarding.\"\n    );\n  }\n\n  warnings.forEach(warning => {\n    diag.warn(warning);\n  });\n\n  return warnings.length === 0;\n};\n"],"names":["nsfConfigValidation","diag","featureManager","registerGlobally","propagator","defaultInstrumentationConfig","isNetworkSpanForwardingEnabled","warnings","push","omit","has","forEach","warning","warn","length"],"mappings":";;AAYO,MAAMA,mBAAAA,GAAsB,CAAC,EAClCC,IAAI,EACJC,cAAc,EACdC,gBAAgB,EAChBC,UAAU,EACVC,4BAA4B,EACT,GAAA;IACnB,IAAI,CAACH,cAAAA,CAAeI,8BAA8B,EAAA,EAAI;QACpD,OAAO,KAAA;AACT,IAAA;AAEA,IAAA,MAAMC,WAAW,EAAE;AAEnB,IAAA,IAAI,CAACJ,gBAAAA,EAAkB;AACrBI,QAAAA,QAAAA,CAASC,IAAI,CACX,sHAAA,CAAA;AAEJ,IAAA;AAEA,IAAA,IAAIJ,UAAAA,EAAY;AACdG,QAAAA,QAAAA,CAASC,IAAI,CACX,8GAAA,CAAA;AAEJ,IAAA;IAEA,IACEH,4BAAAA,EAA8BI,MAAMC,GAAAA,CAClC,iDAAA,CAAA,IAEFL,6BAA6BI,IAAI,CAACC,GAAG,CACnC,sCAAA,CAAA,EAEF;QACAH,QAAAA,CAASC,IAAI,CACX,yGAAA,GACE,0FAAA,CAAA;AAEN,IAAA;IAEAD,QAAAA,CAASI,OAAO,CAACC,CAAAA,OAAAA,GAAAA;AACfX,QAAAA,IAAAA,CAAKY,IAAI,CAACD,OAAAA,CAAAA;AACZ,IAAA,CAAA,CAAA;IAEA,OAAOL,QAAAA,CAASO,MAAM,KAAK,CAAA;AAC7B;;;;"}