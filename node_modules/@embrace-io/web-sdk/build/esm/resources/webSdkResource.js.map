{"version":3,"file":"webSdkResource.js","sources":["../../../src/resources/webSdkResource.ts"],"sourcesContent":["import type { Resource } from '@opentelemetry/resources';\nimport { resourceFromAttributes } from '@opentelemetry/resources';\nimport {\n  ATTR_SERVICE_NAME,\n  ATTR_TELEMETRY_SDK_LANGUAGE,\n  ATTR_TELEMETRY_SDK_NAME,\n  ATTR_TELEMETRY_SDK_VERSION,\n  ATTR_USER_AGENT_ORIGINAL,\n} from '@opentelemetry/semantic-conventions';\nimport {\n  EMBRACE_SERVICE_NAME,\n  NATIVE_FRAMEWORK,\n  SDK_VERSION,\n  TEMPLATE_APP_VERSION,\n} from './constants/index.js';\nimport { KEY_EMB_APP_INSTANCE_ID } from '../constants/index.js';\nimport { getAppInstanceId } from './appInstanceId.js';\nimport type { GetWebSDKResourceArgs } from './types.js';\n\nexport const getWebSDKResource = ({\n  diagLogger,\n  appVersion,\n  pageSessionStorage,\n}: GetWebSDKResourceArgs): Resource => {\n  /* We need to trim the app  version to remove any leading/trailing spaces\n    added by our cli tool. This is required to guarantee that the version is always\n    20 characters long in the final bundle, so sourcemaps don't get confused by\n    changing the length of the inlined app version. E.g. versions \"0.0.1\" and \"0.0.115\"\n    are both valid, but injecting them without leading whitespaces will result in\n    different lengths, pushing the sourcemaps mapping out of range. Instead,\n    \"               0.0.1\" and \"             0.0.115\" are both 20 characters long,\n    and we trim them before loading at runtime\n\n    if the app version has been passed as an argument, we use it instead of the\n    one processed by our cli tool. This will allow for no cli installations,\n    like importing the web sdk from a CDN\n    */\n  const processedAppVersion = appVersion ?? TEMPLATE_APP_VERSION.trim();\n\n  return resourceFromAttributes({\n    [ATTR_SERVICE_NAME]: EMBRACE_SERVICE_NAME,\n    [ATTR_TELEMETRY_SDK_NAME]: EMBRACE_SERVICE_NAME,\n    app_version: processedAppVersion,\n    app_framework: NATIVE_FRAMEWORK,\n    sdk_version: SDK_VERSION,\n    [ATTR_TELEMETRY_SDK_VERSION]: SDK_VERSION,\n    sdk_simple_version: 1,\n    sdk_platform: 'web',\n    [ATTR_TELEMETRY_SDK_LANGUAGE]: 'webjs',\n    [KEY_EMB_APP_INSTANCE_ID]: getAppInstanceId(pageSessionStorage, diagLogger),\n    [ATTR_USER_AGENT_ORIGINAL]: window.navigator.userAgent,\n    screen_resolution: `${window.screen.width}x${window.screen.height}`,\n  });\n};\n"],"names":["getWebSDKResource","diagLogger","appVersion","pageSessionStorage","processedAppVersion","TEMPLATE_APP_VERSION","trim","resourceFromAttributes","ATTR_SERVICE_NAME","EMBRACE_SERVICE_NAME","ATTR_TELEMETRY_SDK_NAME","app_version","app_framework","NATIVE_FRAMEWORK","sdk_version","SDK_VERSION","ATTR_TELEMETRY_SDK_VERSION","sdk_simple_version","sdk_platform","ATTR_TELEMETRY_SDK_LANGUAGE","KEY_EMB_APP_INSTANCE_ID","getAppInstanceId","ATTR_USER_AGENT_ORIGINAL","window","navigator","userAgent","screen_resolution","screen","width","height"],"mappings":";;;;;;AAmBO,MAAMA,oBAAoB,CAAC,EAChCC,UAAU,EACVC,UAAU,EACVC,kBAAkB,EACI,GAAA;AACtB;;;;;;;;;;;;AAYE,OACF,MAAMC,mBAAAA,GAAsBF,UAAAA,IAAcG,oBAAAA,CAAqBC,IAAI,EAAA;AAEnE,IAAA,OAAOC,sBAAAA,CAAuB;AAC5B,QAAA,CAACC,oBAAoBC,oBAAAA;AACrB,QAAA,CAACC,0BAA0BD,oBAAAA;QAC3BE,WAAAA,EAAaP,mBAAAA;QACbQ,aAAAA,EAAeC,gBAAAA;QACfC,WAAAA,EAAaC,WAAAA;AACb,QAAA,CAACC,6BAA6BD,WAAAA;QAC9BE,kBAAAA,EAAoB,CAAA;QACpBC,YAAAA,EAAc,KAAA;AACd,QAAA,CAACC,8BAA8B,OAAA;QAC/B,CAACC,uBAAAA,GAA0BC,gBAAAA,CAAiBlB,kBAAAA,EAAoBF,UAAAA,CAAAA;AAChE,QAAA,CAACqB,wBAAAA,GAA2BC,MAAAA,CAAOC,SAAS,CAACC,SAAS;AACtDC,QAAAA,iBAAAA,EAAmB,CAAA,EAAGH,MAAAA,CAAOI,MAAM,CAACC,KAAK,CAAC,CAAC,EAAEL,MAAAA,CAAOI,MAAM,CAACE,MAAM,CAAA;AACnE,KAAA,CAAA;AACF;;;;"}