{"version":3,"file":"withEmbraceRoutingLegacy.js","sources":["../../../../../../../src/instrumentations/navigation/NavigationInstrumentation/react/reactRouterV5/withEmbraceRoutingLegacy.ts"],"sourcesContent":["import * as React from 'react';\nimport hoistNonReactStatics from 'hoist-non-react-statics';\nimport type {\n  RouteComponentProps,\n  SwitchedRouteComponentProps,\n} from './types.js';\nimport { getNavigationInstrumentation } from '../../index.js';\nimport { EMB_NAVIGATION_INSTRUMENTATIONS } from '../../../../../constants/index.js';\n\nexport const withEmbraceRoutingLegacy = <P extends RouteComponentProps>(\n  WrappedComponent: React.ComponentType<P>\n) => {\n  const navigationInstrumentation = getNavigationInstrumentation();\n  navigationInstrumentation.setInstrumentationType(\n    EMB_NAVIGATION_INSTRUMENTATIONS.DeclarativeLegacy\n  );\n\n  const RouteWithEmbraceRoutingLegacy: React.FC<P> = (props: P) => {\n    // Make sure this is Route component\n    if (props.path) {\n      // Routes get injected with computedMatch when they are children of a <Switch> but the types do not reflect that\n      // Manually setting the type here.\n      const routeProps = props as SwitchedRouteComponentProps;\n\n      // Depends on this internal behaviour\n      // https://github.com/remix-run/react-router/blob/v5.3.4/packages/react-router/modules/Switch.js#L40\n      // It shouldn't change as this version is legacy, and it's not being actively worked on\n      if (routeProps.computedMatch) {\n        navigationInstrumentation.setCurrentRoute({\n          path: routeProps.computedMatch.path,\n          url: routeProps.computedMatch.url,\n        });\n      }\n    }\n\n    return React.createElement<P>(WrappedComponent, props);\n  };\n\n  // Keep wrapped component metadata\n  RouteWithEmbraceRoutingLegacy.displayName = `withEmbraceRoutingLegacy(${WrappedComponent.displayName || WrappedComponent.name || 'Component'})`;\n  hoistNonReactStatics(RouteWithEmbraceRoutingLegacy, WrappedComponent);\n\n  return RouteWithEmbraceRoutingLegacy;\n};\n"],"names":["withEmbraceRoutingLegacy","WrappedComponent","navigationInstrumentation","getNavigationInstrumentation","setInstrumentationType","EMB_NAVIGATION_INSTRUMENTATIONS","DeclarativeLegacy","RouteWithEmbraceRoutingLegacy","props","path","routeProps","computedMatch","setCurrentRoute","url","React","createElement","displayName","name","hoistNonReactStatics"],"mappings":";;;;;AASO,MAAMA,2BAA2B,CACtCC,gBAAAA,GAAAA;AAEA,IAAA,MAAMC,yBAAAA,GAA4BC,4BAAAA,EAAAA;IAClCD,yBAAAA,CAA0BE,sBAAsB,CAC9CC,+BAAAA,CAAgCC,iBAAiB,CAAA;AAGnD,IAAA,MAAMC,gCAA6C,CAACC,KAAAA,GAAAA;;QAElD,IAAIA,KAAAA,CAAMC,IAAI,EAAE;;;AAGd,YAAA,MAAMC,UAAAA,GAAaF,KAAAA;;;;YAKnB,IAAIE,UAAAA,CAAWC,aAAa,EAAE;AAC5BT,gBAAAA,yBAAAA,CAA0BU,eAAe,CAAC;oBACxCH,IAAAA,EAAMC,UAAAA,CAAWC,aAAa,CAACF,IAAI;oBACnCI,GAAAA,EAAKH,UAAAA,CAAWC,aAAa,CAACE;AAChC,iBAAA,CAAA;AACF,YAAA;AACF,QAAA;QAEA,OAAOC,KAAAA,CAAMC,aAAa,CAAId,gBAAAA,EAAkBO,KAAAA,CAAAA;AAClD,IAAA,CAAA;;AAGAD,IAAAA,6BAAAA,CAA8BS,WAAW,GAAG,CAAC,yBAAyB,EAAEf,gBAAAA,CAAiBe,WAAW,IAAIf,gBAAAA,CAAiBgB,IAAI,IAAI,WAAA,CAAY,CAAC,CAAC;AAC/IC,IAAAA,oBAAAA,CAAqBX,6BAAAA,EAA+BN,gBAAAA,CAAAA;IAEpD,OAAOM,6BAAAA;AACT;;;;"}