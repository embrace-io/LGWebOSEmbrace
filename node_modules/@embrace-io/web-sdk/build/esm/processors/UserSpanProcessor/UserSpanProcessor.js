import { ATTR_USER_ID } from '@opentelemetry/semantic-conventions/incubating';

/**
 * UserSpanProcessor sets the userId attribute on all spans if the userId is set in the UserManager.
 */ class UserSpanProcessor {
    constructor({ userManager }){
        this._userManager = userManager;
    }
    forceFlush() {
        return Promise.resolve(undefined);
    }
    // TODO `onEnd` is not supposed to modify the span. There is a new experimental onEnding api that allows modifying
    // using onEnd to make sure we get the userId at the last possible moment in case it was set up after the span was started.
    onEnd(span) {
        const userId = this._userManager.getUserId();
        if (userId) {
            span.attributes[ATTR_USER_ID] = userId;
        }
    }
    onStart() {
    // do nothing.
    }
    shutdown() {
        return Promise.resolve(undefined);
    }
}

export { UserSpanProcessor };
//# sourceMappingURL=UserSpanProcessor.js.map
